import{_ as i,c as a,ab as n,o as l}from"./chunks/framework.BphAXvUg.js";const t="/blog-site/assets/image-20200930093138095.DHJoM-uK.png",e="/blog-site/assets/image-20200930093340440.C3TrEHhQ.png",h="/blog-site/assets/image-20200930095657645.Dzfr82le.png",p="/blog-site/assets/image-20200930095723714.D7Y7yCCg.png",k="/blog-site/assets/image-20200930095738422.CXJx6Zj1.png",d="/blog-site/assets/image-20200930092151499.BygABej9.png",r="/blog-site/assets/image-20200930093920999.D4up8Rc1.png",o="/blog-site/assets/image-20200930101124618.Bks7DWAA.png",c="/blog-site/assets/image-20200930101531056.Bdi0v9pP.png",E="/blog-site/assets/image-20200930102739815.DARJbfNo.png",g="/blog-site/assets/image-20200930011415008.BIUHsV-I.png",y="/blog-site/assets/image-20200930111249812.BB_MdzO0.png",u="/blog-site/assets/image-20201103160036392.sA9YHweI.png",b="/blog-site/assets/image-20200930114719682.BmcfLser.png",F="/blog-site/assets/image-20200930151838974.DsDYuZ5r.png",f=JSON.parse('{"title":"微信小程序云开发","description":"","frontmatter":{"outline":"deep"},"headers":[],"relativePath":"mp-weixin/2微信云开发/2小程序云开发.md","filePath":"mp-weixin/2微信云开发/2小程序云开发.md"}'),m={name:"mp-weixin/2微信云开发/2小程序云开发.md"};function C(q,s,v,B,A,x){return l(),a("div",null,s[0]||(s[0]=[n('<h1 id="微信小程序云开发" tabindex="-1">微信小程序云开发 <a class="header-anchor" href="#微信小程序云开发" aria-label="Permalink to &quot;微信小程序云开发&quot;">​</a></h1><h2 id="介绍" tabindex="-1">介绍 <a class="header-anchor" href="#介绍" aria-label="Permalink to &quot;介绍&quot;">​</a></h2><p>开发者可以使用云开发开发微信小程序、小游戏，<code>无需搭建服务器</code>，即可使用云端能力。</p><p>相当于全栈方向。</p><h2 id="新建云开发项目" tabindex="-1">新建云开发项目 <a class="header-anchor" href="#新建云开发项目" aria-label="Permalink to &quot;新建云开发项目&quot;">​</a></h2><img src="'+t+'" alt="image-20200930093138095" style="zoom:50%;"><img src="'+e+'" alt="image-20200930093340440" style="zoom:50%;"><h2 id="开通小程序·云开发" tabindex="-1">开通小程序·云开发 <a class="header-anchor" href="#开通小程序·云开发" aria-label="Permalink to &quot;开通小程序·云开发&quot;">​</a></h2><ol><li>云开发提供了免费的接口服务器，免费的存储空间，免费的数据库。</li><li>第一次使用需要开通服务，同时创建云开发环境。</li></ol><img src="'+h+'" alt="image-20200930095657645" style="zoom:33%;"><img src="'+p+'" alt="image-20200930095723714" style="zoom:50%;"><img src="'+k+'" alt="image-20200930095738422" style="zoom:50%;"><p><img src="'+d+'" alt="image-20200930092151499"></p><h2 id="新建环境" tabindex="-1">新建环境 <a class="header-anchor" href="#新建环境" aria-label="Permalink to &quot;新建环境&quot;">​</a></h2><p>记得复制环境名字，开发的时候需要用到。 <code>hm54-9ggy9ynhd3c080fb</code></p><p><img src="'+r+'" alt="image-20200930093920999"></p><h2 id="云开发后端和传统服务器后端差别" tabindex="-1">云开发后端和传统服务器后端差别 <a class="header-anchor" href="#云开发后端和传统服务器后端差别" aria-label="Permalink to &quot;云开发后端和传统服务器后端差别&quot;">​</a></h2><h3 id="传统服务器后端" tabindex="-1">传统服务器后端 <a class="header-anchor" href="#传统服务器后端" aria-label="Permalink to &quot;传统服务器后端&quot;">​</a></h3><ol><li>前端开发者无法直接读取和写入文件，无法直接操作数据库。</li><li>前端要读写文件，操作数据，需要依赖服务端环境，通过发送请求和接收响应实现业务。</li></ol><img src="'+o+'" alt="image-20200930101124618" style="zoom:50%;"><h3 id="小程序云开发" tabindex="-1">小程序云开发 <a class="header-anchor" href="#小程序云开发" aria-label="Permalink to &quot;小程序云开发&quot;">​</a></h3><p>小程序云开发，主要多了两大功能：</p><ol><li>小程序可以直接上传资源到云存储空间。</li><li>小程序可以直接对数据库进行增删改查操作。</li></ol><p>有点：这个转变可以让小程序前端拥有更强的能力，后端变得没有那么重要了。</p><img src="'+c+'" alt="image-20200930101531056" style="zoom:50%;"><h3 id="云开发核心3大概念" tabindex="-1">云开发核心3大概念 <a class="header-anchor" href="#云开发核心3大概念" aria-label="Permalink to &quot;云开发核心3大概念&quot;">​</a></h3><ol><li>云数据库</li><li>云存储</li><li>云函数</li></ol><h2 id="云存储" tabindex="-1">云存储 <a class="header-anchor" href="#云存储" aria-label="Permalink to &quot;云存储&quot;">​</a></h2><ol><li>免费环境提供 <code>5G</code> 存储空间，可以上传 <code>html</code> 页面，图片，视频等资源。</li><li><code>cloud://</code> 这种协议只能在小程序内部使用。</li><li>浏览器能识别的 <code>https://</code> 这种协议的地址。</li><li>如果要在其他项目中引入云存储的资源，请使用 <code>https://</code> 这种地址。</li><li>云储存还提供了对应的 <code>API</code>，可以直接通过小程序端<code>代码实现上传</code>。</li></ol><img src="'+E+`" alt="image-20200930102739815" style="zoom:50%;"><h2 id="小程序端-文件上传" tabindex="-1">小程序端 - 文件上传 <a class="header-anchor" href="#小程序端-文件上传" aria-label="Permalink to &quot;小程序端 - 文件上传&quot;">​</a></h2><h3 id="文件上传主要分两步" tabindex="-1">文件上传主要分两步 <a class="header-anchor" href="#文件上传主要分两步" aria-label="Permalink to &quot;文件上传主要分两步&quot;">​</a></h3><ol><li>选择文件。</li><li>上传文件。</li></ol><h3 id="选择文件" tabindex="-1">选择文件 <a class="header-anchor" href="#选择文件" aria-label="Permalink to &quot;选择文件&quot;">​</a></h3><p><code>wx.chooseImage()</code></p><p><code>wx.chooseVideo()</code></p><p><code>wx.chooseMedia()</code></p><h3 id="上传文件-api" tabindex="-1">上传文件 API <a class="header-anchor" href="#上传文件-api" aria-label="Permalink to &quot;上传文件 API&quot;">​</a></h3><div class="language-jsx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">wx.cloud.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">uploadFile</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  cloudPath: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;example.png&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 存储时的文件名</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  filePath: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, 			</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 要上传文件资源的路径</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">then</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">res</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(res.fileID)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">error</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // handle error</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div><h3 id="注意事项" tabindex="-1">注意事项 <a class="header-anchor" href="#注意事项" aria-label="Permalink to &quot;注意事项&quot;">​</a></h3><ol><li>将本地资源上传至云存储空间</li><li>如果上传至同一路径则是覆盖写入，所以上传的时候注意改名。</li></ol><h2 id="新建云开发环境-注意" tabindex="-1">新建云开发环境 - 注意 <a class="header-anchor" href="#新建云开发环境-注意" aria-label="Permalink to &quot;新建云开发环境 - 注意&quot;">​</a></h2><ol><li>设置 - 新建环境，并复制名称 ，注意每个同学的环境变量都不一样。<code>gfg-5bd181(仅供参考)</code></li></ol><h2 id="云数据库" tabindex="-1">云数据库 <a class="header-anchor" href="#云数据库" aria-label="Permalink to &quot;云数据库&quot;">​</a></h2><h3 id="新建数据库集合" tabindex="-1">新建数据库集合 <a class="header-anchor" href="#新建数据库集合" aria-label="Permalink to &quot;新建数据库集合&quot;">​</a></h3><ol><li><p>新建的集合可以理解为就是一个 <code>json</code> 文件。</p></li><li><p>可以通过点击记录手动添加数据。</p></li><li><p>可以导入 <code>json</code> 文件 和 导出 <code>json</code> 文件。</p></li></ol><h3 id="注意事项-踩坑" tabindex="-1">注意事项 - 踩坑 <a class="header-anchor" href="#注意事项-踩坑" aria-label="Permalink to &quot;注意事项 - 踩坑&quot;">​</a></h3><ul><li>导出和导入的 <code>json</code> 文件和我们之前学习的不一样。</li><li>云开发导入和导出的 <code>json</code> 文件，<code>一条数据占一行</code>，而且每条数据之间<code>不需要用逗号结束</code>。</li><li>所以通过按钮点击导入导出平常比较少用，更多的是通过代码的方式导入数据。</li></ul><h3 id="新建集合步骤" tabindex="-1">新建集合步骤 <a class="header-anchor" href="#新建集合步骤" aria-label="Permalink to &quot;新建集合步骤&quot;">​</a></h3><p><img src="`+g+'" alt="image-20200930011415008"></p><h2 id="小程序端项目精简" tabindex="-1">小程序端项目精简 <a class="header-anchor" href="#小程序端项目精简" aria-label="Permalink to &quot;小程序端项目精简&quot;">​</a></h2><p><img src="'+y+`" alt="image-20200930111249812"></p><h2 id="数据库操作-🚩" tabindex="-1">数据库操作- 🚩 <a class="header-anchor" href="#数据库操作-🚩" aria-label="Permalink to &quot;数据库操作- 🚩&quot;">​</a></h2><h3 id="云环境初始化" tabindex="-1">云环境初始化 <a class="header-anchor" href="#云环境初始化" aria-label="Permalink to &quot;云环境初始化&quot;">​</a></h3><blockquote><p>在调用云开发各 <code>API</code> 前，需先调用初始化方法 <code>init</code> 一次（全局只需一次，多次调用时只有第一次生效）</p></blockquote><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 1. 初始化云环境</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//app.js</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">App</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 小程序启动时触发的生命周期函数</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  onLaunch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> () {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      // 全局只需一次，多次调用时只有第一次生效</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      wx.cloud.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">init</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        env: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;itcast-zftt8&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div><h3 id="连接数据库并打开某个集合" tabindex="-1">连接数据库并打开某个集合 <a class="header-anchor" href="#连接数据库并打开某个集合" aria-label="Permalink to &quot;连接数据库并打开某个集合&quot;">​</a></h3><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 2. 连接云数据库</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> db</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> wx.clound.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">database</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 3. 打开 hero 集合(文件)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> heroCollection</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> db.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">collection</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;hero&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div><h3 id="增加" tabindex="-1">增加 <a class="header-anchor" href="#增加" aria-label="Permalink to &quot;增加&quot;">​</a></h3><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	data:{</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		name:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;小明&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div><h3 id="查询全部" tabindex="-1">查询全部 <a class="header-anchor" href="#查询全部" aria-label="Permalink to &quot;查询全部&quot;">​</a></h3><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span></code></pre></div><h3 id="修改集合数据权限" tabindex="-1">修改集合数据权限 <a class="header-anchor" href="#修改集合数据权限" aria-label="Permalink to &quot;修改集合数据权限&quot;">​</a></h3><ol><li>云数据库有权限的概念：默认情况下，哪个用户新增的数据，哪个用户可以查看和修改，其他用户看不到。</li><li>如果想要让新增的数据给所有小程序用户都能查询到，可以修改数据库集合的权限。</li></ol><p><img src="`+u+`" alt="image-20201103160036392"></p><p>PS：为了开发更加方便操作<code>数据库</code>，数据权限建议选择<code>自定义安全规则</code>。</p><p>测试阶段把规则设置为 <code>允许所有用户可读，允许所有用户可写</code>，配置参考如下：</p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;read&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;write&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p><img src="`+b+`" alt="image-20200930114719682"></p><h3 id="根据id查询" tabindex="-1">根据id查询 <a class="header-anchor" href="#根据id查询" aria-label="Permalink to &quot;根据id查询&quot;">​</a></h3><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">doc</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(_id)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span></code></pre></div><h3 id="模糊条件查询" tabindex="-1">模糊条件查询 <a class="header-anchor" href="#模糊条件查询" aria-label="Permalink to &quot;模糊条件查询&quot;">​</a></h3><p>可通过 <code>正则表达式</code> 配合 <code>where</code> 条件进行模糊匹配。</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 原生 JavaScript 对象</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">where</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  name:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;">李白</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">i</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 把字符串转成正则对象</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">where</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  name: db.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">RegExp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    regexp: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;李白&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    options: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;i&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span></code></pre></div><table tabindex="0"><thead><tr><th style="text-align:left;">flag</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:left;">i</td><td style="text-align:left;">大小写不敏感</td></tr><tr><td style="text-align:left;">m</td><td style="text-align:left;">跨行匹配；让开始匹配符 <code>^</code> 或结束匹配符 <code>$</code> 时除了匹配字符串的开头和结尾外，还匹配行的开头和结尾</td></tr></tbody></table><h3 id="删除" tabindex="-1">删除 <a class="header-anchor" href="#删除" aria-label="Permalink to &quot;删除&quot;">​</a></h3><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">doc</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(_id)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">remove</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span></code></pre></div><h3 id="修改" tabindex="-1">修改 <a class="header-anchor" href="#修改" aria-label="Permalink to &quot;修改&quot;">​</a></h3><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">doc</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(_id)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    data: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    	键名称: 值</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div><h3 id="数据搜索" tabindex="-1">数据搜索 <a class="header-anchor" href="#数据搜索" aria-label="Permalink to &quot;数据搜索&quot;">​</a></h3><p><img src="`+F+`" alt="image-20200930151838974"></p><h2 id="项目初始化" tabindex="-1">项目初始化 <a class="header-anchor" href="#项目初始化" aria-label="Permalink to &quot;项目初始化&quot;">​</a></h2><p>注意事项：进入 <code>miniprogram</code> 文件夹，再执行初始化 npm 项目和 安装 npm 包的命令。</p><p>常见错误：直接在根云开发项目的目录初始化。</p><h3 id="安装-vant-ui-小程序版" tabindex="-1">安装 Vant UI 小程序版 <a class="header-anchor" href="#安装-vant-ui-小程序版" aria-label="Permalink to &quot;安装 Vant UI 小程序版&quot;">​</a></h3><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 进入 小程序项目目录</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> miniprogram</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 初始化项目</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">npm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> init</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 安装 vant UI 组件库</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">npm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> @vant/weapp</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -S</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --production</span></span></code></pre></div><h3 id="构建-npm-包-🚩" tabindex="-1">构建 <code>npm</code> 包 🚩 <a class="header-anchor" href="#构建-npm-包-🚩" aria-label="Permalink to &quot;构建 \`npm\` 包 🚩&quot;">​</a></h3><p><img src="https://img.yzcdn.cn/public_files/2019/08/15/fa0549210055976cb63798503611ce3d.png" alt="img"></p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// app.json</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;usingComponents&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;van-search&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;@vant/weapp/search/index&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">van-search</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;{{ value }}&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  shape</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;round&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  background</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;#00B26A&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  placeholder</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;请输入英雄名称&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span></code></pre></div><h2 id="app实例" tabindex="-1">App实例 <a class="header-anchor" href="#app实例" aria-label="Permalink to &quot;App实例&quot;">​</a></h2><p><code>App</code> 实例其实类似 <code>Vue</code> 实例，都是全局的实例。</p><p>只不过小程序的全局 <code>App</code> 实例在页面中使用的时候，需要先通过 <code>getApp()</code></p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//app.js</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">App</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  onLaunch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(){</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 1. 初始化云环境</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    wx.cloud.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">init</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({env: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;hm54-9ggy9ynhd3c080fb&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 自己的环境名称 </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 2. 连接云数据库</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> db</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> wx.cloud.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">database</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 3. 打开 hero 集合(文件) - 并把集合对象添加到全局 app 对象上</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.hero </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> db.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">collection</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;hero&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 自己新建的集合名称</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div><p>页面中获取全局<code>App</code>实例</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 获取 App 全局实例</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> app</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> getApp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(app);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 直接调用</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getApp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">().hero.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span></code></pre></div>`,96)]))}const _=i(m,[["render",C]]);export{f as __pageData,_ as default};
